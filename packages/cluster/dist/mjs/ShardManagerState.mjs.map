{"version":3,"file":"ShardManagerState.mjs","names":["PodWithMetadata","ShardId","equals","pipe","HashMap","HashSet","List","Option","make","pods","shards","podVersions","values","fromIterable","map","extractVersion","maxVersion","reduce","empty","curr","a","compareVersion","result","size","none","some","shardsPerPodPods","optionPod","shardId","isNone","has","value","modify","add","set","shardsPerPod","union","allPodsHaveMaxVersion","every","_","unassignedShards","filter","k","averageShardsPerPod","isEmpty"],"sources":["../src/ShardManagerState.ts"],"sourcesContent":[null],"mappings":"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"}