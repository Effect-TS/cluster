{"version":3,"file":"ShardingServiceHttp.mjs","names":["Either","HashSet","Effect","Layer","Http","ShardingProtocolHttp","jsonStringify","uint8ArrayFromStringStream","Sharding","ShardingConfig","Stream","createServer","internalServer","unwrapEffect","gen","_","config","server","layer","port","shardingPort","shardingServiceHttp","scopedDiscard","sharding","router","empty","pipe","post","body","request","schemaBodyJson","AssignShard_","assign","fromIterable","shards","response","json","UnassignShards_","unassign","get","Send_","result","sendToLocalEntitySingleReply","message","match","onFailure","left","onSuccess","right","schemaJson","SendResult_","SendStream_","mapEffect","SendStreamResultItem_","catchAll","e","succeed","map","sendToLocalEntityStreamingReply","stream","contentType","serve","middleware","logger","use"],"sources":["../src/ShardingServiceHttp.ts"],"sourcesContent":[null],"mappings":"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"}