{"version":3,"file":"ShardingServiceHttp.mjs","names":["Http","ShardingProtocolHttp","jsonStringify","uint8ArrayFromStringStream","Sharding","ShardingConfig","Effect","Either","pipe","HashSet","Layer","Stream","createServer","internalServer","unwrapEffect","gen","_","config","server","layer","port","shardingPort","shardingServiceHttp","scopedDiscard","sharding","router","empty","post","body","request","schemaBodyJson","AssignShard_","assign","fromIterable","shards","response","json","UnassignShards_","unassign","get","Send_","result","sendToLocalEntitySingleReply","message","match","onFailure","left","onSuccess","right","schemaJson","SendResult_","SendStream_","sendToLocalEntityStreamingReply","map","catchAll","e","succeed","mapEffect","SendStreamResultItem_","stream","contentType","serve","middleware","logger","use"],"sources":["../src/ShardingServiceHttp.ts"],"sourcesContent":[null],"mappings":"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"}