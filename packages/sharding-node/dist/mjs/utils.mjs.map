{"version":3,"file":"utils.mjs","names":["Chunk","Effect","Schema","TreeFormatter","ShardingError","Stream","fetch","FetchError","url","body","error","_tag","isFetchError","value","jsonStringify","schema","map","_","JSON","stringify","mapError","e","ShardingErrorSerialization","formatErrors","errors","encode","jsonParse","flatMap","decode","sync","parse","sendInternal","send","data","tryPromise","try","signal","method","catch","String","reply","flatten","orDie","response","promise","text","sendStream","fromEffect","mapEffect","line","startsWith","substring","length","trim","filter","splitLines","toString","fromAsyncIterable","stringFromUint8ArrayString","encoding","stream","decoder","TextDecoder","mapChunks","bytes","uint8ArrayFromStringStream","TextEncoder","strings"],"sources":["../src/utils.ts"],"sourcesContent":[null],"mappings":"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"}