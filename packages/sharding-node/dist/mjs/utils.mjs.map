{"version":3,"file":"utils.mjs","names":["Chunk","pipe","Effect","Schema","TreeFormatter","ShardingError","Stream","fetch","FetchError","url","body","error","_tag","isFetchError","value","jsonStringify","schema","encode","mapError","e","ShardingErrorSerialization","formatErrors","errors","map","_","JSON","stringify","jsonParse","sync","parse","flatMap","decode","sendInternal","send","data","tryPromise","try","signal","method","catch","String","reply","response","promise","text","orDie","flatten","sendStream","fromAsyncIterable","toString","splitLines","filter","line","length","startsWith","substring","trim","mapEffect","fromEffect","stringFromUint8ArrayString","encoding","stream","decoder","TextDecoder","mapChunks","bytes","uint8ArrayFromStringStream","TextEncoder","strings"],"sources":["../src/utils.ts"],"sourcesContent":[null],"mappings":"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"}